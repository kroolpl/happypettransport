---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';

// Import hero image
import heroImage from '../assets/pets.jpeg';

// Import all testimonial images
import lunaImage from '../assets/testimonials/luna.jpg';
import maxImage from '../assets/testimonials/max.jpg';
import bellaImage from '../assets/testimonials/bella.jpg';

// Define image sizes for different breakpoints
const imageSizes = {
  mobile: {
    width: 640,
    height: 360
  },
  tablet: {
    width: 1024,
    height: 576
  },
  desktop: {
    width: 1920,
    height: 1080
  }
};

// Add structured data for SEO
const structuredData = {
  "@context": "https://schema.org",
  "@type": "Service",
  "name": "Happy Pet Transport",
  "description": "Professional pet transport services across UK, Poland, and EU",
  "provider": {
    "@type": "Organization",
    "name": "Happy Pet Transport"
  },
  "areaServed": {
    "@type": "Continent",
    "name": "Europe"
  }
};

const testimonials = [
  {
    name: 'Luna',
    image: lunaImage,
    role: 'German Shepherd, UK to Poland',
    quote: 'The humans were so nice! They gave me treats and belly rubs during breaks. Best road trip ever! ðŸ¦´'
  },
  {
    name: 'Max',
    image: maxImage,
    role: 'British Shorthair, Poland to Germany',
    quote: 'I slept through most of it in my cozy carrier, but the air conditioning was purrfect! ðŸ˜º'
  },
  {
    name: 'Bella',
    image: bellaImage,
    role: 'Golden Retriever, France to UK',
    quote: 'Made so many friends at the rest stops! The humans even let me keep my favorite toy. Woof-tastic service! ðŸŽ¾'
  }
];
---

<Layout 
  title="Happy Pet Transport - Safe Pet Transport Across Europe"
  description="Professional pet transport services between UK, Poland, and EU countries. Licensed, insured, and focused on pet comfort and safety."
  heroImage={heroImage}
>
  <!-- Add structured data -->
  <script type="application/ld+json" set:html={JSON.stringify(structuredData)} />

  <main>
    <!-- Hero Section -->
    <section class="relative bg-gradient-to-br from-myrtle/90 to-cadet/90 text-white pt-28 pb-16 md:py-24 overflow-hidden">
      <div class="absolute inset-0 -z-10">
        <picture>
          <!-- Mobile image -->
          <source
            media="(max-width: 640px)"
            srcset={
              `${heroImage.src}?w=${imageSizes.mobile.width}&h=${imageSizes.mobile.height}&q=80 1x,
               ${heroImage.src}?w=${imageSizes.mobile.width * 2}&h=${imageSizes.mobile.height * 2}&q=80 2x`
            }
          />
          <!-- Tablet image -->
          <source
            media="(max-width: 1024px)"
            srcset={
              `${heroImage.src}?w=${imageSizes.tablet.width}&h=${imageSizes.tablet.height}&q=80 1x,
               ${heroImage.src}?w=${imageSizes.tablet.width * 2}&h=${imageSizes.tablet.height * 2}&q=80 2x`
            }
          />
          <!-- Desktop image -->
          <Image
            src={heroImage}
            alt="Happy pets ready for safe transport across Europe"
            class="w-full h-full object-cover opacity-20"
            width={imageSizes.desktop.width}
            height={imageSizes.desktop.height}
            loading="eager"
            decoding="sync"
            fetchpriority="high"
            quality={80}
          />
        </picture>
      </div>

      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12 items-center">
          <div class="animate-slide-up">
            <span class="bg-accent/20 text-white px-4 py-1 rounded-full text-sm font-semibold mb-6 inline-block hover:bg-accent/30 transition-colors cursor-default">
              Trusted Pet Transport
            </span>
            <h1 class="font-heading text-4xl md:text-5xl font-bold mb-6">
              Safe & Comfortable Pet Transport Across Europe
            </h1>
            <p class="text-lg mb-8 text-gray-100">
              Specialized in pet transport between UK, Poland, and EU countries. Your pets' comfort and safety is our top priority.
            </p>
            <div class="flex gap-4">
              <a href="/contact" class="bg-accent text-white px-8 py-3 rounded-lg font-semibold hover:bg-accent/90 transition-all duration-300 hover:scale-105 transform animate-breath">
                Get a Quote
              </a>
              <a href="/services" class="border-2 border-accent text-white px-8 py-3 rounded-lg font-semibold hover:bg-accent hover:border-accent transition-all duration-300 hover:scale-105 transform">
                Learn More
              </a>
            </div>
          </div>
          
          <div class="relative h-[300px] md:h-[500px] md:block animate-float">
            <div class="absolute inset-0 bg-accent/20 rounded-lg transform rotate-6 transition-transform duration-700 hover:rotate-12"></div>
            <Image
              src={heroImage}
              alt="Happy pets ready for safe transport across Europe"
              class="absolute inset-0 w-full h-full object-cover rounded-lg shadow-xl transform -rotate-3 hover:rotate-0 transition-all duration-700 hover:scale-105"
            />
          </div>
        </div>
      </div>
    </section>

    <!-- Features Section -->
    <section class="py-16 md:py-24" aria-labelledby="features-heading">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16 animate-slide-up">
          <span class="bg-accent/10 text-accent px-4 py-1 rounded-full text-sm font-semibold mb-4 inline-block hover:bg-accent/20 transition-colors cursor-default">
            Why Choose Us
          </span>
          <h2 id="features-heading" class="font-heading text-3xl font-bold text-cadet">The PetTransport EU Difference</h2>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 transform animate-slide-up">
            <div class="w-14 h-14 bg-accent/10 rounded-full flex items-center justify-center mb-6 animate-pulse-soft">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-accent" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <h3 class="font-heading text-xl font-bold mb-3 text-cadet">Licensed & Insured</h3>
            <p class="text-slate">Fully compliant with all EU pet transport regulations and insurance requirements.</p>
          </div>
          <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 transform animate-slide-up [animation-delay:200ms]">
            <div class="w-14 h-14 bg-accent/10 rounded-full flex items-center justify-center mb-6 animate-pulse-soft">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-accent" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <h3 class="font-heading text-xl font-bold mb-3 text-cadet">24/7 Support</h3>
            <p class="text-slate">Stay updated about your pet's journey with our round-the-clock customer support.</p>
          </div>
          <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 transform animate-slide-up [animation-delay:400ms]">
            <div class="w-14 h-14 bg-accent/10 rounded-full flex items-center justify-center mb-6 animate-pulse-soft">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-accent" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
              </svg>
            </div>
            <h3 class="font-heading text-xl font-bold mb-3 text-cadet">Pet Comfort</h3>
            <p class="text-slate">Climate-controlled vehicles and regular comfort breaks for your pet's well-being.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Testimonials Section -->
    <section class="py-16 md:py-24 bg-slate/5">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16 animate-slide-up">
          <span class="bg-accent/10 text-accent px-4 py-1 rounded-full text-sm font-semibold mb-4 inline-block hover:bg-accent/20 transition-colors cursor-default">
            Pawsitive Reviews
          </span>
          <h2 class="font-heading text-3xl font-bold text-cadet">What Our Furry Clients Say</h2>
        </div>

        <!-- Desktop Grid -->
        <div class="hidden md:grid md:grid-cols-3 gap-8">
          {testimonials.map((testimonial, index) => (
            <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] animate-slide-up relative mt-10" style={`animation-delay: ${index * 200}ms`}>
              <div class="absolute -top-10 left-1/2 -translate-x-1/2 w-20 h-20 rounded-full border-4 border-white shadow-lg overflow-hidden">
                <Image
                  src={testimonial.image}
                  alt={`${testimonial.name}'s portrait`}
                  class="w-full h-full object-cover"
                  width={80}
                  height={80}
                  quality="high"
                />
              </div>
              <div class="pt-12">
                <p class="text-slate italic mb-4">"{testimonial.quote}"</p>
                <div class="flex justify-between items-center border-t border-slate/10 pt-4">
                  <div>
                    <p class="font-heading font-bold text-cadet">{testimonial.name}</p>
                    <p class="text-sm text-slate">{testimonial.role}</p>
                  </div>
                  <div class="flex gap-1">
                    {Array(5).fill('').map(() => (
                      <svg class="w-5 h-5 text-accent" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                      </svg>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>

        <!-- Mobile Carousel -->
        <div class="md:hidden relative">
          <div class="overflow-hidden">
            <div id="testimonialSlider" class="flex transition-transform duration-300 ease-out">
              {testimonials.map((testimonial, index) => (
                <div class="w-full flex-shrink-0 px-4">
                  <div class="bg-white p-6 rounded-xl shadow-lg relative mt-10">
                    <div class="absolute -top-10 left-1/2 -translate-x-1/2 w-20 h-20 rounded-full border-4 border-white shadow-lg overflow-hidden">
                      <Image
                        src={testimonial.image}
                        alt={`${testimonial.name}'s portrait`}
                        class="w-full h-full object-cover"
                        width={80}
                        height={80}
                        quality="high"
                      />
                    </div>
                    <div class="pt-12">
                      <p class="text-slate italic mb-4">"{testimonial.quote}"</p>
                      <div class="flex justify-between items-center border-t border-slate/10 pt-4">
                        <div>
                          <p class="font-heading font-bold text-cadet">{testimonial.name}</p>
                          <p class="text-sm text-slate">{testimonial.role}</p>
                        </div>
                        <div class="flex gap-1">
                          {Array(5).fill('').map(() => (
                            <svg class="w-5 h-5 text-accent" fill="currentColor" viewBox="0 0 20 20">
                              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                            </svg>
                          ))}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          <!-- Carousel Controls -->
          <div class="flex justify-center items-center mt-8 gap-4">
            <button 
              id="prevSlide"
              class="p-2 rounded-full bg-white shadow-md text-accent hover:bg-accent hover:text-white transition-colors duration-300"
              aria-label="Previous testimonial"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
              </svg>
            </button>

            <!-- Dots -->
            <div class="flex gap-2" id="slideDots">
              {testimonials.map((_, index) => (
                <button
                  class={`w-2 h-2 rounded-full transition-all duration-300 ${index === 0 ? 'bg-accent w-4' : 'bg-accent/30'}`}
                  aria-label={`Go to slide ${index + 1}`}
                  data-index={index}
                />
              ))}
            </div>

            <button 
              id="nextSlide"
              class="p-2 rounded-full bg-white shadow-md text-accent hover:bg-accent hover:text-white transition-colors duration-300"
              aria-label="Next testimonial"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="bg-gradient-to-r from-myrtle to-cadet py-16 md:py-24 relative overflow-hidden" aria-labelledby="cta-heading">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative animate-slide-up">
        <span class="bg-accent/20 text-white px-4 py-1 rounded-full text-sm font-semibold mb-6 inline-block hover:bg-accent/30 transition-colors cursor-default">
          Get Started
        </span>
        <h2 id="cta-heading" class="font-heading text-3xl font-bold mb-6 text-white">Ready to Transport Your Pet?</h2>
        <p class="text-lg text-gray-100 mb-8 max-w-2xl mx-auto">
          Get in touch for a personalized quote and let us take care of your pet's journey with the utmost care and professionalism.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a 
            href="/contact" 
            class="bg-accent text-white px-8 py-3 rounded-lg font-semibold hover:bg-accent/90 transition-all duration-300 hover:scale-105 transform focus:ring-2 focus:ring-offset-2 focus:ring-accent focus:outline-none"
          >
            Contact Us
          </a>
          <a 
            href="/services" 
            class="border-2 border-accent text-white px-8 py-3 rounded-lg font-semibold hover:bg-accent hover:border-accent transition-all duration-300 hover:scale-105 transform focus:ring-2 focus:ring-offset-2 focus:ring-accent focus:outline-none"
          >
            Our Services
          </a>
        </div>
      </div>
    </section>
  </main>
</Layout>

<script>
  // Carousel functionality
  let currentSlide = 0;
  const slider = document.getElementById('testimonialSlider');
  const slides = slider?.children;
  const dots = document.querySelectorAll('#slideDots button');
  const totalSlides = slides?.length || 0;

  function updateSlider() {
    if (slider && slides) {
      const offset = -100 * currentSlide;
      slider.style.transform = `translateX(${offset}%)`;

      // Update dots
      dots.forEach((dot, index) => {
        if (index === currentSlide) {
          dot.classList.add('bg-accent', 'w-4');
          dot.classList.remove('bg-accent/30');
        } else {
          dot.classList.remove('bg-accent', 'w-4');
          dot.classList.add('bg-accent/30');
        }
      });
    }
  }

  function nextSlide() {
    if (currentSlide < totalSlides - 1) {
      currentSlide++;
    } else {
      currentSlide = 0;
    }
    updateSlider();
  }

  function prevSlide() {
    if (currentSlide > 0) {
      currentSlide--;
    } else {
      currentSlide = totalSlides - 1;
    }
    updateSlider();
  }

  // Event listeners
  document.getElementById('nextSlide')?.addEventListener('click', nextSlide);
  document.getElementById('prevSlide')?.addEventListener('click', prevSlide);

  // Dot navigation
  dots.forEach((dot) => {
    dot.addEventListener('click', () => {
      const index = parseInt(dot.getAttribute('data-index') || '0');
      currentSlide = index;
      updateSlider();
    });
  });

  // Auto-advance slides every 5 seconds
  setInterval(nextSlide, 5000);

  // Touch support for swiping
  let touchStartX = 0;
  let touchEndX = 0;

  slider?.addEventListener('touchstart', (e) => {
    touchStartX = e.changedTouches[0].screenX;
  });

  slider?.addEventListener('touchend', (e) => {
    touchEndX = e.changedTouches[0].screenX;
    handleSwipe();
  });

  function handleSwipe() {
    const swipeThreshold = 50;
    const diff = touchStartX - touchEndX;

    if (Math.abs(diff) > swipeThreshold) {
      if (diff > 0) {
        nextSlide();
      } else {
        prevSlide();
      }
    }
  }
</script>